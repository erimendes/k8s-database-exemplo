<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <title>Mensagens</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>

<nav class="navbar navbar-dark bg-dark">
  <a class="navbar-brand ms-3" href="/">Home</a>
</nav>

<div class="container mt-4">
  <h2>Mensagens</h2>
  <ul id="lista" class="list-group"></ul>
</div>

<script>
const socket = io();
function addMsg(m){
  const li=document.createElement("li");
  li.className="list-group-item";
  li.innerHTML=`<b>${m.usuario}</b>: ${m.mensagem}
  <br><small>${m.criado}</small>`;
  lista.prepend(li);
}
socket.on("nova_mensagem", addMsg);

fetch("/api/mensagens").then(r=>r.json()).then(msgs=>msgs.forEach(addMsg));
</script>
</body>
</html>
